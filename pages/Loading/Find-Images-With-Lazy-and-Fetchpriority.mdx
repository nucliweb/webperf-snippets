import snippet from '../../snippets/Loading/Find-Images-With-Lazy-and-Fetchpriority.js?raw'
import { Snippet } from '../../components/Snippet'

# Find Images With Loading Lazy and Fetchpriority

Detects images that have both `loading="lazy"` and `fetchpriority="high"` - a contradictory combination that indicates a misconfiguration.

**Why this is a problem:**

| Attribute | Purpose | When to use |
|-----------|---------|-------------|
| `loading="lazy"` | Defer loading until near viewport | Below-the-fold images |
| `fetchpriority="high"` | Prioritize loading over other resources | Critical above-the-fold images (LCP) |

Using both together sends mixed signals to the browser:
- "Don't load this initially" (`lazy`)
- "But when you do load it, make it high priority" (`high`)

This is contradictory because high-priority resources should load immediately, not be deferred.

> "In reality you probably wouldn't really want `loading=lazy` and `fetchpriority=high` at the same time. That would mean don't load it initially, but when you start to load it, load it with high priority. Which is kind of contradictory!" - [Barry Pollard](https://twitter.com/tunetheweb/status/1714750391890444582)

> **Related:** Use the [Find Above The Fold Lazy Loaded Images](/Loading/Find-Above-The-Fold-Lazy-Loaded-Images) snippet to detect lazy-loaded images in the viewport that may be hurting LCP.

### Attribution

Based on the [script](https://twitter.com/csswizardry/status/1714697877245632832) shared by [Harry Roberts](https://csswizardry.com/).

### Snippet

<Snippet code={snippet} />

### Understanding the Results

The snippet checks for the contradictory combination and provides context:

**For each conflicting element:**

| Field | Description |
|-------|-------------|
| `selector` | CSS selector path to identify the element |
| `dimensions` | Rendered width × height |
| `inViewport` | Whether the image is currently visible |
| `isLcpCandidate` | Whether this is the largest viewport image |
| `src` | Image source URL (truncated) |

**Recommendations:**

Based on the image position, the snippet suggests which attribute to keep:

| Image Position | Recommendation |
|----------------|----------------|
| In viewport / LCP | Remove `loading="lazy"`, keep `fetchpriority="high"` |
| Outside viewport | Remove `fetchpriority="high"`, keep `loading="lazy"` |

### Best Practices

**For critical above-the-fold images (especially LCP):**

```html
<img src="hero.jpg" fetchpriority="high" alt="Hero image">
```

**For below-the-fold images:**

```html
<img src="content.jpg" loading="lazy" alt="Content image">
```

**Never combine both:**

```html
<!-- ❌ Contradictory - don't do this -->
<img src="image.jpg" loading="lazy" fetchpriority="high" alt="...">
```

### Further Reading

- [Fetch Priority API](https://web.dev/articles/fetch-priority) | web.dev
- [Browser-level lazy loading](https://web.dev/articles/browser-level-image-lazy-loading) | web.dev
- [Optimizing resource loading with Priority Hints](https://developer.chrome.com/docs/web-platform/performance/resource-priorities) | Chrome Developers
